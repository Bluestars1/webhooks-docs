{
	"info": {
		"_postman_id": "0eb900f9-b3ec-414c-a03c-276ce9e85281",
		"name": "Postman collection for Tableau Webhooks",
		"description": "Work with the developer preview of webhooks for Tableau. This collection contains all REST API calls needed to create, delete, list, and test webhooks. Syntax is provided for both XML and JSON payloads. For convenience the collection also contains variables that you need to set for your server and, after signin, the site ID and auth token.",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
	},
	"item": [
		{
			"name": "JSON",
			"item": [
				{
					"name": "Sign-in",
					"event": [
						{
							"listen": "test",
							"script": {
								"id": "6e4d3cd4-838a-4355-9e9f-70c1b3aee7c7",
								"exec": [
									"var response = JSON.parse(responseBody);",
									"",
									"// Set the Site_ID environment variable to what we get back from the response",
									"pm.environment.set(\"Site_ID\", response.credentials.site.id);",
									"",
									"// Set the Tableau_Auth_Token environment variable to what we get back from the response",
									"pm.environment.set(\"Tableau_Auth_Token\", response.credentials.token);",
									""
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "Accept",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"credentials\": {\r\n     \"site\": {\r\n        \"contentUrl\": \"{{Site_Name}}\"\r\n     },\r\n     \"name\": \"{{User_Name}}\",\r\n     \"password\": \"{{Password}}\"\r\n  }\r\n}"
						},
						"url": {
							"raw": "{{Tableau_Server}}/api/3.1/auth/signin",
							"host": [
								"{{Tableau_Server}}"
							],
							"path": [
								"api",
								"3.1",
								"auth",
								"signin"
							]
						},
						"description": "Sign-in and get an auth token from Tableau. Then update the Postman collection variables to use the returned auth token and site ID."
					},
					"response": []
				},
				{
					"name": "List webhooks",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "X-Tableau-Auth",
								"value": "{{Tableau_Auth_Token}}"
							},
							{
								"key": "Accept",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": ""
						},
						"url": {
							"raw": "{{Tableau_Server}}/{{REST_API_Version}}/sites/{{Site_ID}}/webhooks",
							"host": [
								"{{Tableau_Server}}"
							],
							"path": [
								"{{REST_API_Version}}",
								"sites",
								"{{Site_ID}}",
								"webhooks"
							]
						},
						"description": "List all configured webhooks for the given site."
					},
					"response": []
				},
				{
					"name": "Get a webhook",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "X-Tableau-Auth",
								"value": "{{Tableau_Auth_Token}}"
							},
							{
								"key": "Accept",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": ""
						},
						"url": {
							"raw": "{{Tableau_Server}}/{{REST_API_Version}}/sites/{{Site_ID}}/webhooks/{{Webhook_ID}}",
							"host": [
								"{{Tableau_Server}}"
							],
							"path": [
								"{{REST_API_Version}}",
								"sites",
								"{{Site_ID}}",
								"webhooks",
								"{{Webhook_ID}}"
							]
						},
						"description": "Gets a single webhook by its ID."
					},
					"response": []
				},
				{
					"name": "Create a webhook",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "X-Tableau-Auth",
								"value": "{{Tableau_Auth_Token}}"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "Accept",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n   \"webhook\": {\r\n      \"webhook-source\": {\r\n         \"webhook-source-event-workbook-created\": {}\r\n      },\r\n      \"webhook-destination\": {\r\n         \"webhook-destination-http\": {\r\n            \"method\": \"POST\",\r\n            \"url\": \"https://<REPLACE_ME>\"\r\n         }\r\n      },\r\n      \"name\": \"MY_WEBHOOK\"\r\n   }\r\n}"
						},
						"url": {
							"raw": "{{Tableau_Server}}/{{REST_API_Version}}/sites/{{Site_ID}}/webhooks",
							"host": [
								"{{Tableau_Server}}"
							],
							"path": [
								"{{REST_API_Version}}",
								"sites",
								"{{Site_ID}}",
								"webhooks"
							]
						},
						"description": "Creates a new webhook on the given site using the event type and destination URL provided."
					},
					"response": []
				},
				{
					"name": "Delete a webhook",
					"request": {
						"method": "DELETE",
						"header": [
							{
								"key": "X-Tableau-Auth",
								"value": "{{Tableau_Auth_Token}}"
							},
							{
								"key": "Accept",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": ""
						},
						"url": {
							"raw": "{{Tableau_Server}}/{{REST_API_Version}}/sites/{{Site_ID}}/webhooks/{{Webhook_ID}}",
							"host": [
								"{{Tableau_Server}}"
							],
							"path": [
								"{{REST_API_Version}}",
								"sites",
								"{{Site_ID}}",
								"webhooks",
								"{{Webhook_ID}}"
							]
						},
						"description": "Delete a single webhook by its ID."
					},
					"response": []
				},
				{
					"name": "Test a webhook",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "X-Tableau-Auth",
								"value": "{{Tableau_Auth_Token}}"
							},
							{
								"key": "Accept",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": ""
						},
						"url": {
							"raw": "{{Tableau_Server}}/{{REST_API_Version}}/sites/{{Site_ID}}/webhooks/{{Webhook_ID}}/test",
							"host": [
								"{{Tableau_Server}}"
							],
							"path": [
								"{{REST_API_Version}}",
								"sites",
								"{{Site_ID}}",
								"webhooks",
								"{{Webhook_ID}}",
								"test"
							]
						},
						"description": "Test a single webhook."
					},
					"response": []
				}
			]
		},
		{
			"name": "XML",
			"item": [
				{
					"name": "Sign-in",
					"event": [
						{
							"listen": "test",
							"script": {
								"id": "b7926a92-051b-494c-8386-204412bdeab9",
								"exec": [
									"var response = xml2Json(responseBody);",
									"",
									"// Set the Site_ID environment variable to what we get back from the response",
									"pm.environment.set(\"Site_ID\", response.tsResponse.credentials.site.$.id);",
									"",
									"// Set the Tableau_Auth_Token environment variable to what we get back from the response",
									"pm.environment.set(\"Tableau_Auth_Token\", response.tsResponse.credentials.$.token);",
									""
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "<tsRequest>\r\n  <credentials name=\"{{User_Name}}\" password=\"{{Password}}\" >\r\n    <site contentUrl=\"{{Site_Name}}\" />\r\n  </credentials>\r\n</tsRequest>"
						},
						"url": {
							"raw": "{{Tableau_Server}}/api/3.1/auth/signin",
							"host": [
								"{{Tableau_Server}}"
							],
							"path": [
								"api",
								"3.1",
								"auth",
								"signin"
							]
						},
						"description": "Sign-in and get an auth token from Tableau. Then update the Postman collection variables to use the returned auth token and site ID."
					},
					"response": []
				},
				{
					"name": "List webhooks",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "X-Tableau-Auth",
								"value": "{{Tableau_Auth_Token}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": ""
						},
						"url": {
							"raw": "{{Tableau_Server}}/{{REST_API_Version}}/sites/{{Site_ID}}/webhooks",
							"host": [
								"{{Tableau_Server}}"
							],
							"path": [
								"{{REST_API_Version}}",
								"sites",
								"{{Site_ID}}",
								"webhooks"
							]
						},
						"description": "List all configured webhooks for the given site."
					},
					"response": []
				},
				{
					"name": "Get a webhook",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "X-Tableau-Auth",
								"value": "{{Tableau_Auth_Token}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": ""
						},
						"url": {
							"raw": "{{Tableau_Server}}/{{REST_API_Version}}/sites/{{Site_ID}}/webhooks/{{Webhook_ID}}",
							"host": [
								"{{Tableau_Server}}"
							],
							"path": [
								"{{REST_API_Version}}",
								"sites",
								"{{Site_ID}}",
								"webhooks",
								"{{Webhook_ID}}"
							]
						},
						"description": "Gets a single webhook by its ID."
					},
					"response": []
				},
				{
					"name": "Create a webhook",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "X-Tableau-Auth",
								"value": "{{Tableau_Auth_Token}}"
							},
							{
								"key": "Content-Type",
								"value": "application/xml"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "<tsRequest>\n  <webhook name=\"<REPLACE_ME>\">\n    <webhook-source>\n      <webhook-source-event-datasource-refresh-started />\n    </webhook-source>\n    <webhook-destination>\n      <webhook-destination-http method=\"POST\" url=\"https://<REPLACE_ME>\" />\n    </webhook-destination>\n  </webhook>\n</tsRequest>\n"
						},
						"url": {
							"raw": "{{Tableau_Server}}/{{REST_API_Version}}/sites/{{Site_ID}}/webhooks",
							"host": [
								"{{Tableau_Server}}"
							],
							"path": [
								"{{REST_API_Version}}",
								"sites",
								"{{Site_ID}}",
								"webhooks"
							]
						},
						"description": "Creates a new webhook on the given site using the event type and destination URL provided."
					},
					"response": []
				},
				{
					"name": "Delete a webhook",
					"request": {
						"method": "DELETE",
						"header": [
							{
								"key": "X-Tableau-Auth",
								"value": "{{Tableau_Auth_Token}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": ""
						},
						"url": {
							"raw": "{{Tableau_Server}}/{{REST_API_Version}}/sites/{{Site_ID}}/webhooks/{{Webhook_ID}}",
							"host": [
								"{{Tableau_Server}}"
							],
							"path": [
								"{{REST_API_Version}}",
								"sites",
								"{{Site_ID}}",
								"webhooks",
								"{{Webhook_ID}}"
							]
						},
						"description": "Delete a single webhook by its ID."
					},
					"response": []
				},
				{
					"name": "Test a webhook",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "X-Tableau-Auth",
								"value": "{{Tableau_Auth_Token}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": ""
						},
						"url": {
							"raw": "{{Tableau_Server}}/{{REST_API_Version}}/sites/{{Site_ID}}/webhooks/{{Webhook_ID}}/test",
							"host": [
								"{{Tableau_Server}}"
							],
							"path": [
								"{{REST_API_Version}}",
								"sites",
								"{{Site_ID}}",
								"webhooks",
								"{{Webhook_ID}}",
								"test"
							]
						},
						"description": "Test a single webhook."
					},
					"response": []
				}
			],
			"description": "Webhooks requests using XML payloads."
		}
	],
	"event": [
		{
			"listen": "prerequest",
			"script": {
				"id": "7871142f-77c4-47b2-9bfa-bc897a556676",
				"type": "text/javascript",
				"exec": [
					""
				]
			}
		},
		{
			"listen": "test",
			"script": {
				"id": "8c4f5f91-5cfc-4298-825a-a79aab1ffcc9",
				"type": "text/javascript",
				"exec": [
					""
				]
			}
		}
	],
	"variable": [
		{
			"id": "9d43a395-d1ba-4304-83c6-8e93ae390826",
			"key": "Tableau_Server",
			"value": "http://localhost/",
			"type": "string"
		},
		{
			"id": "80dc12fe-58c6-49cd-aafa-38808db5bd54",
			"key": "REST_API_Version",
			"value": "api/exp/",
			"type": "string"
		},
		{
			"id": "dd7d60f1-4b3b-4969-920f-2db533ae444e",
			"key": "Site_ID",
			"value": "<Replace_Me>",
			"type": "string"
		},
		{
			"id": "787f8292-952d-4ec4-ae0a-1cfd004c9670",
			"key": "Tableau_Auth_Token",
			"value": "<Replace_Me>",
			"type": "string"
		},
		{
			"id": "9c14ba14-cd85-4610-a674-8dc5c0dd4c78",
			"key": "Webhook_ID",
			"value": "<Replace_Me>",
			"type": "string"
		}
	]
}
